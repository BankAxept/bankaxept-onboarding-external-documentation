{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome","text":"<p>Welcome to BankAxept's documentation.</p> <ul> <li>Getting Started with BankAxept Onboarding</li> <li>You can view our Swagger documentation for test and production environments. Our test documentation includes additional endpoints to allow simulation of actions taking place throughout the order lifecycle. </li> </ul>"},{"location":"api_policy/","title":"API Design guidlines","text":""},{"location":"api_policy/#time","title":"Time","text":"<p>All API elements must specify time using UTC.</p>"},{"location":"api_policy/#versioning","title":"Versioning","text":"<p>While this API is not versioned in the URI this following scheme should be expected in case of future changes and updates.</p> <ul> <li>Major version: This version will be used in the URI, like <code>/v2/</code>, and indicates breaking changes to the API. Internally, the URI is utilized to route to the   correct internal execution.</li> <li>Minor and Patch versions: These versions remain transparent in the API and are used internally for backward-compatible additions and updates.</li> </ul> <p>Diverging from the above versioning scheme requires approval from all integrators.</p>"},{"location":"api_policy/#api-lifecycle","title":"API Lifecycle","text":"<p>We strive to keep our API backwards compatible in order to minimize the impact on our integrators. The following changes are considered backwards compatible.</p>"},{"location":"api_policy/#expanding-a-response-with-an-optional-field","title":"Expanding a response with an optional field.","text":"<p>As long as a field is optional it is considered backwards compatible to add it to a response. This means that the integrator can choose to ignore the field if it is not needed. This should be unproblematic, but bear this constraint in mind regarding any automation and validation tied to our Swagger files. As well as overly strict response deserialization.</p> <p><code>Response parsing must be robust and ignore any unknown fields.</code></p>"},{"location":"api_policy/#relaxing-validation-rules","title":"Relaxing validation rules","text":"<p>For example making the required length of a string shorter. This is considered backwards compatible as long as the integrator can still send the same data as before.</p>"},{"location":"api_policy/#correcting-bugserrors-that-does-not-change-intended-behavior","title":"Correcting bugs/errors that does not change intended behavior.","text":"<p>Correcting a bug, for example correcting an incorrect/malformed error returned in an edge case, is considered backwards compatible as long as the integrator can still send the same data as before in the intended flows.</p>"},{"location":"configuration/","title":"Onboarding","text":""},{"location":"configuration/#getting-credentials","title":"Getting credentials","text":"<p>In order to use the Onboarding API, you will need to obtain client credentials from BankAxept. Please get in touch with your BankAxept partner manager to obtain the necessary credentials You will need separate credentials for the test and production environments.</p>"},{"location":"configuration/#getting-an-access-token","title":"Getting an access token","text":"<p>All requests to the Onboarding API must include an access token in the Authorization header. To get an access token you must make a request to the <code>/token</code> endpoint with your client credentials as specified in the OAuth 2.0 specification. The request should contain an authorization header using the Basic authentication scheme, i.e. base64 encode the string <code>client_id:client_secret</code> and include it in the header. The following is an example request using a client ID of <code>client-id</code> and a client secret of <code>client-secret</code>:</p> <pre><code>POST https://sso.test.stoe.no/auth/realms/external/protocol/openid-connect/token\n     Authorization: Basic Y2xpZW50LWlkOmNsaWVudC1zZWNyZXQ=\n     Content-Type: application/x-www-form-urlencoded\n\n     grant_type=client_credentials\n</code></pre> <p>The response will contain an access token that you can use to authenticate your requests to the Onboarding API. The access token is a JSON Web Token (JWT) and will look something like this:</p> <pre><code>{\n  \"access_token\": \"access-token-example\",\n  \"expires_in\": 300,\n  \"refresh_expires_in\": 0,\n  \"token_type\": \"Bearer\",\n  \"not-before-policy\": 0,\n  \"scope\": \"\"\n}\n</code></pre> <p>The URL for the token endpoint is different for the test and production environments: - Test environment: <code>https://sso.test.stoe.no/auth/realms/external/protocol/openid-connect/token</code> - Production environment: <code>https://sso.stoe.no/auth/realms/external/protocol/openid-connect/token</code></p>"},{"location":"configuration/#sending-requests","title":"Sending requests","text":"<p>All requests to the Onboarding API must include the access token in the Authorization header. We recommend requesting a new token for each request as they have an expiry time of five minutes. The header should look like this:</p> <pre><code>Authorization: Bearer access-token-example\n</code></pre>"},{"location":"dictionary/","title":"Dictionary","text":"<p>This dictionary includes internal, external and technical terms used in the BankAxept ecosystem. This is intended to be a general lightweight reference to reduce confusion and improve communication.</p> Term Explanation API Application Programming Interface PSP Payment Service Provider Bax number A six or seven digit number associated with a payment terminal Baxbis The system operated by Nets which issues bax numbers and maintains the network necessary for payment terminals to work Bank reg number Identifying number for a bank. A bank can have several bank reg numbers, but 2 banks can never share the same number. BRREG Br\u00f8nn\u00f8ysundregistrene is the national register of Norwegian businesses their site can be found here https://www.brreg.no/ JWT JSON Web Token MCC The Merchant Category Code (MCC) is a four-digit number assigned to describe a Merchant\u2019s primary business based on annual sales volume measured in local currency. KAR Account and Addressing Register (KAR)"},{"location":"getting_started/","title":"Introduction","text":"<p>Welcome to the Getting Started guide for the BankAxept Onboarding API.</p>"},{"location":"getting_started/#introduction","title":"Introduction","text":"<p>This is an API for Norwegian PSPs to register new Bax numbers which are automatically assigned BankAxept products. Following a merchant agreement registration request BankAxept will:</p> <ul> <li>Create a Bax number in Baxbis</li> <li>Create a financial agreement document between the issuing bank and the customer, if needed.</li> <li>Create an agreement between BankAxept and the customer, if needed.</li> <li>Collect any necessary signature(s) using the signee and contact information provided in the request.</li> </ul> <p>Bax numbers are loaded onto payment terminals in order to connect them to the payment network. Baxbis is the system operated by Nets which issues bax numbers and maintains the network necessary for payment terminals to work.</p>"},{"location":"getting_started/#limitations","title":"Limitations","text":"<p>This API does not support bank accounts that are not owned by the organization entering into the agreement.  For example, Enkeltpersonforetak accounts might be registered on the owners Norwegian national identity number instead of their organization number. This will cause the KAR check to fail since the account is not connected to the organization.   In these cases the order must go through Nets Ordrekontor.</p> <p>This API allows for ordering the BankAxept product \"return of goods\". The number of days in which a good can be returned after sale (the return window) will be set to the default value of 30 days.</p> <p>If a customer requires a return period longer than 30 days, or if the return applies to chain stores that needs \"Chain return of goods\", please contact BankAxept Support at bankaxept@stoe.no</p>"},{"location":"getting_started/#setting-up-your-onboarding-integration","title":"Setting up your Onboarding integration","text":"<p>There are multiple points of configuration that need to be aligned before you can fully utilize the Onboarding API. The necessary steps may be found in our Configuration Guide.</p>"},{"location":"getting_started/#possible-order-statuses","title":"Possible Order Statuses","text":"Status Description BAX_NOT_CREATED The agreement has been created in our system but does not yet have an associated Bax number. NOT_SIGNED The agreement has not been signed yet. PENDING_BANK_RESPONSE The agreement has been signed by the customer and is waiting for the bank to approve the signatures. BAX_ACTIVE The agreement has been activated but the bank has not given final approval. REJECTED_RECREATE_SIGNING The agreement has been rejected by the bank. This is not a terminal state and can be moved by calling the <code>/recreate-signing-order</code> endpoint. ACCEPTED The agreement has received final approval from the bank. This is a terminal state. REJECTED_CREATE_NEW_ORDER The agreement has received final rejection This is a terminal state. A new order needs to be created."},{"location":"getting_started/#order-statuses-flowchart","title":"Order Statuses Flowchart","text":"<pre><code>graph TD\n    A[Register new agreement] --&gt; B((BAX_NOT_CREATED))\n    B --&gt;|Bax created| C((NOT_SIGNED))\n    C --&gt; H[Signed]\n    H --&gt;|Signatures not automatically validated| D((PENDING_BANK_RESPONSE))\n    H --&gt;|Signatures automatically validated| E((BAX_ACTIVE))\n    E --&gt;|Bank rejects| F((REJECTED))\n    D --&gt;|Bank rejects| F((REJECTED))\n    D --&gt;|Bank approves| G((ACCEPTED))\n    D --&gt;|Automatic timeout| E((BAX_ACTIVE))\n    E --&gt;|Bank approves| G((ACCEPTED))\n    F --&gt;|Resend signing request| C((NOT_SIGNED))\n</code></pre>"},{"location":"getting_started/#integration-guidelines","title":"Integration Guidelines","text":"<p>We validate the following information when registering an agreement:  Account Ownership: We validate that the account number belongs to the customer.  Account Number: We validate that the account number is valid and belongs to the customer.  MCC: We validate that the MCC is valid and supported. You can find a list of supported MCCs in our MCC documentation.</p>"},{"location":"getting_started/#test","title":"Test","text":"<p>Account numbers are validated during the registration process.  The first four digits of the account number is always the bank reg number.  We validate that the bank reg number is in our list of valid settlement banks.   In the test environment, you must use a valid DNB bank registration number. For example 7001.   This applies whether you are bypassing validation or actively testing the KAR implementation.   If you are testing the KAR implementation without bypassing validation, you must also use an organization number that is linked to a valid DNB account. You can read more about valid account numbers in our documentation. </p> <p>For a list of valid registration numbers, refer to BITS documentation. You can view our flow diagrams for the test environment here.</p>"},{"location":"getting_started/#production","title":"Production","text":"<p>You can view our flow diagrams for the production environment here. </p>"},{"location":"getting_started/#webhooks","title":"Webhooks","text":"<p>You can view more information about webhooks here. </p>"},{"location":"mcc_codes/","title":"MCC Codes","text":"<p>Following you will find a list of Merchant Category Codes (MCC) used in the BankAxept ecosystem.</p> Code Description 1520 General Contractors-Residential and Commercial 1711 Air Conditioning Contractors \u2013 Sales and Installation, Heating Contractors \u2013 Sales, Service, Installation 1731 Electrical Contractors 1740 Insulation \u2013 Contractors, Masonry, Stonework Contractors, Plastering Contractors, Stonework and Masonry Contractors, Tile Settings Contractors 1750 Carpentry Contractors 1761 Roofing \u2013 Contractors, Sheet Metal Work \u2013 Contractors, Siding \u2013 Contractors 1799 Contractors \u2013 Special Trade, Not Elsewhere Classified 2741 Miscellaneous Publishing and Printing 4111 Local/Suburban Commuter Passenger Transportation \u2013 Railroads, Feries, Local Water Transportation. 4112 Passenger Railways 4121 Taxicabs and Limousines 4122 Bus Lines, Including Charters, Tour Buses 4214 Motor Freight Carriers, Moving and Storage Companies, Trucking \u2013 Local/Long Distance, Delivery Services \u2013 Local 4215 Courier Services \u2013 Air or Ground, Freight forwarders 4225 Public warehousing, Storage 4411 Cruise and Steamship Lines 4468 Marinas, Marine Service, and Supplies 4511 Airlines, Air Carriers ( not listed elsewhere) 4582 Airports, Airport Terminals, Flying Fields 4722 Travel Agencies and Tour Operations 4784 Toll and Bridge Fees 4789 Transportation Services, ( not listed elsewhere) 4812 Telecommunications Equipment including telephone sales 4814 Fax services, Telecommunication Services 4816 Computer Network Services 4899 Cable and other pay television (previously Cable Services) 4900 Electric, Gas, Sanitary and Water Utilities 5013 Motor Vehicle Supplies and New Parts 5021 Office and Commercial Furniture 5039 Construction Materials, Not Elsewhere Classified 5045 Computers, Computer Peripheral Equipment, Software 5046 Commercial Equipment, Not Elsewhere Classified 5047 Medical, Dental Ophthalmic, Hospital Equipment and Supplies 5065 Electrical Parts and Equipment 5072 Hardware Equipment and Supplies 5074 Plumbing and Heating Equipment and Supplies 5085 Industrial Supplies, Not Elsewhere Classified 5094 Precious Stones and Metals, Watches and Jewelry 5099 Durable Goods, Not Elsewhere Classified 5122 Drugs, Drug Proprietors, and Druggist\u2019s Sundries 5131 Piece Goods, Notions, and Other Dry Goods 5137 Men\u2019s Women\u2019s and Children\u2019s Uniforms and Commercial Clothing 5172 Petroleum and Petroleum Products 5192 Books, Periodicals, and Newspapers 5193 Florists\u2019 Supplies, Nursery Stock and Flowers 5198 Paints, Varnishes, and Supplies 5199 Non-durable Goods, Not Elsewhere Classified 5200 Home Supply Warehouse Stores 5211 Lumber and Building Materials Stores 5231 Glass, Paint, and Wallpaper Stores 5251 Hardware Stores 5261 Nurseries \u2013 Lawn and Garden Supply Store 5271 Mobile Home Dealers 5300 Wholesale Clubs 5309 Duty Free Store 5310 Discount Stores 5311 Department Stores 5331 Variety Stores 5399 Misc. General Merchandise 5411 Grocery Stores, Supermarkets 5422 Meat Provisioners \u2013 Freezer and Locker 5441 Candy, Nut, and Confectionery Stores 5462 Bakeries 5499 Misc. Food Stores \u2013 Convenience Stores and Specialty Markets 5511 Car and Truck Dealers (New and Used) Sales, Service, Repairs, Parts, and Leasing 5521 Automobile and Truck Dealers (Used Only) 5531 Automobile Supply Stores 5532 Automotive Tire Stores 5533 Automotive Parts, Accessories Stores 5541 Service Stations ( with or without ancillary services) 5542 Automated Fuel Dispensers 5551 Boat Dealers 5561 Recreational and Utility Trailers, Camp Dealers 5571 Motorcycle Dealers 5592 Motor Home Dealers 5599 Miscellaneous Auto Dealers 5611 Men\u2019s and Boy\u2019s Clothing and Accessories Stores 5621 Women\u2019s Ready-to-Wear Stores 5631 Women\u2019s Accessory and Specialty Shops 5641 Children\u2019s and Infant\u2019s Wear Stores 5651 Family Clothing Stores 5655 Sports Apparel, Riding Apparel Stores 5661 Shoe Stores 5681 Furriers and Fur Shops 5691 Men\u2019s and Women\u2019s Clothing Stores 5697 Tailors, Seamstress, Mending, and Alterations 5699 Miscellaneous Apparel and Accessory Shops 5712 Furniture, Home Furnishings, and Equipment Stores, Except Appliances 5713 Floor Covering Stores 5714 Drapery, Window Covering and Upholstery Stores 5718 Fireplace, Fireplace Screens, and Accessories Stores 5719 Miscellaneous Home Furnishing Specialty Stores 5722 Household Appliance Stores 5732 Electronic Sales 5733 Music Stores, Musical Instruments, Piano Sheet Music 5734 Computer Software Stores 5735 Record Shops 5811 Caterers 5812 Eating places and Restaurants 5813 Drinking Places (Alcoholic Beverages), Bars, Taverns, Cocktail lounges, Nightclubs and Discotheques 5814 Fast Food Restaurants 5815 Digital Goods: Media, Books, Movies, Music 5816 Digital Goods: Games 5817 Digital Goods: Applications (Excludes Games) 5912 Drug Stores and Pharmacies 5921 Package Stores \u2013 Beer, Wine, and Liquor 5931 Used Merchandise and Secondhand Stores 5932 Antique Shops 5935 Wrecking and Salvage Yards 5940 Bicycle Shops \u2013 Sales and Service 5941 Sporting Goods Stores 5942 Book Stores 5943 Stationery Stores, Office and School Supply Stores 5944 Watch, Clock, Jewelry, and Silverware Stores 5945 Hobby, Toy, and Game Shops 5946 Camera and Photographic Supply Stores 5947 Card Shops, Gift, Novelty, and Souvenir Shops 5948 Leather Goods Stores 5949 Sewing, Needle, Fabric, and Price Goods Stores 5950 Glassware/Crystal Stores 5964 Direct Marketing \u2013 Catalog Merchant 5965 Direct Marketing \u2013 Catalog and Catalog and Retail Merchant 5970 Artist\u2019s Supply and Craft Shops 5971 Art Dealers and Galleries 5972 Stamp and Coin Stores \u2013 Philatelic and Numismatic Supplies 5976 Orthopedic Goods Prosthetic Devices 5977 Cosmetic Stores 5983 Fuel \u2013 Fuel Oil, Wood, Coal, Liquefied Petroleum 5992 Florists 5993 Cigar Stores and Stands 5994 News Dealers and Newsstands 5995 Pet Shops, Pet Foods, and Supplies Stores 5996 Swimming Pools \u2013 Sales, Service, and Supplies 5998 Tent and Awning Shops 5999 Miscellaneous and Specialty Retail Stores 6513 Real Estate Agents and Managers \u2013 Rentals 7011 Lodging \u2013 Hotels, Motels, Resorts, Central Reservation Services (not elsewhere classified) 7012 Timeshares 7032 Sporting and Recreational Camps 7033 Trailer Parks and Camp Grounds 7210 Laundry, Cleaning, and Garment Services 7211 Laundry \u2013 Family and Commercial 7216 Dry Cleaners 7221 Photographic Studios 7230 Barber and Beauty Shops 7251 Shoe Repair Shops and Shoe Shine Parlors, and Hat Cleaning Shops 7261 Funeral Service and Crematories 7277 Counseling Service \u2013 Debt, Marriage, Personal 7296 Clothing Rental \u2013 Costumes, Formal Wear, Uniforms 7297 Massage Parlors 7298 Health and Beauty Shops 7299 Miscellaneous Personal Services ( not elsewhere classified) 7333 Commercial Photography, Art and Graphics 7338 Quick Copy, Reproduction and Blueprinting Services 7342 Exterminating and Disinfecting Services 7349 Cleaning and Maintenance, Janitorial Services 7372 Computer Programming, Integrated Systems Design and Data Processing Services 7379 Computer Maintenance and Repair Services, Not Elsewhere Classified 7392 Management, Consulting, and Public Relations Services 7393 Protective and Security Services \u2013 Including Armored Carsand Guard Dogs 7394 Equipment Rental and Leasing Services, Tool Rental, Furniture Rental, and Appliance Rental 7395 Photofinishing Laboratories, Photo Developing 7399 Business Services, Not Elsewhere Classified 7512 Car Rental Companies ( Not Listed Below) 7513 Truck and Utility Trailer Rentals 7519 Motor Home and Recreational Vehicle Rentals 7523 Automobile Parking Lots and Garages 7531 Automotive Body Repair Shops 7534 Tire Re-treading and Repair Shops 7535 Paint Shops \u2013 Automotive 7538 Automotive Service Shops 7542 Car Washes 7549 Towing Services 7622 Radio Repair Shops 7629 Electrical and Small Appliance Repair Shops 7631 Watch, Clock, and Jewelry Repair 7641 Furniture, Furniture Repair, and Furniture Refinishing 7692 Welding Repair Shops 7699 Repair Shops and Related Services \u2013Miscellaneous 7832 Motion Picture Theaters 7841 Video Tape Rental Stores 7922 Theatrical Producers (Except Motion Pictures), Ticket Agencies 7929 Bands, Orchestras, and Miscellaneous Entertainers (Not Elsewhere Classified) 7932 Billiard and Pool Establishments 7933 Bowling Alleys 7941 Commercial Sports, Athletic Fields, Professional Sport Clubs, and Sport Promoters 7991 Tourist Attractions and Exhibits 7992 Golf Courses \u2013 Public 7994 Video Game Arcades/Establishments 7995 Betting (including Lottery Tickets, Casino Gaming Chips, Off-track Betting and Wagers at Race Tracks) 7996 Amusement Parks, Carnivals, Circuses, Fortune Tellers 7997 Membership Clubs (Sports, Recreation, Athletic), Country Clubs, and Private Golf Courses 7998 Aquariums, Sea-aquariums, Dolphinariums 7999 Recreation Services (Not Elsewhere Classified) 8011 Doctors and Physicians (Not Elsewhere Classified) 8021 Dentists and Orthodontists 8031 Osteopaths 8041 Chiropractors 8042 Optometrists and Ophthalmologists 8043 Opticians, Opticians Goods and Eyeglasses 8049 Podiatrists and Chiropodists 8050 Nursing and Personal Care Facilities 8062 Hospitals 8071 Medical and Dental Laboratories 8099 Medical Services and Health Practitioners (Not Elsewhere Classified) 8111 Legal Services and Attorneys 8211 Elementary and Secondary Schools 8220 Colleges, Junior Colleges, Universities, and Professional Schools 8299 Schools and Educational Services (Not Elsewhere Classified) 8398 Charitable and Social Service Organizations 8641 Civic, Fraternal, and Social Associations 8651 Political Organizations 8661 Religious Organizations 8675 Automobile Associations 8699 Membership Organizations ( Not Elsewhere Classified) 8911 Architectural \u2013 Engineering and Surveying Services 8931 Accounting, Auditing, and Bookkeeping Services 8999 Professional Services ( Not Elsewhere Defined) 9222 Fines 9399 Government Services ( Not Elsewhere Classified) 9402 Postal Services \u2013 Government Only"},{"location":"prod_flows/","title":"Valid flows for Production","text":""},{"location":"prod_flows/#automatically-approved-signatures","title":"Automatically Approved Signatures","text":"<p>An order is created with and signed by the correct signee(s) and the signatures are approved</p> <pre><code>sequenceDiagram\nparticipant I as Integrator\nparticipant O as Onboarding API\n\nnote over I, O: Register new agreement\nI -&gt;&gt; O: PUT /register/merchantAgreement\nO --&gt;&gt; I: 200 OK with orderId\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O : GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in NOT_SIGNED status &lt;br/&gt; with a BAX Number\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Verify signing of agreement\nI -&gt;&gt; O: GET /agreement/awaiting-signature\nO --&gt;&gt; I: 200 OK with all Agreements\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O : GET agreement/{orderId}\nnote right of O: This will return the agreement details &lt;br/&gt; after signing has been completed by the merchants it should result in &lt;br/&gt; BAX_ACTIVE status with a BAX Number assuming &lt;br/&gt; the agreement was signed with valid signees\nO --&gt;&gt; I: 200 OK with Agreement\n</code></pre>"},{"location":"prod_flows/#signatures-rejected-by-bank","title":"Signatures Rejected by Bank","text":"<p>An order is created with and signed by the incorrect signee(s) and the signatures are rejected by the bank.</p> <pre><code>sequenceDiagram\nparticipant I as Integrator\nparticipant O as Onboarding API\n\nnote over I, O: Register new agreement\nI -&gt;&gt; O: PUT /register/merchantAgreement\nO --&gt;&gt; I: 200 OK with orderId\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O : GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in NOT_SIGNED status &lt;br/&gt; with a BAX Number\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Verify signing of agreement\nI -&gt;&gt; O: GET /agreement/awaiting-signature\nO --&gt;&gt; I: 200 OK with all Agreements\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O : GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in &lt;br/&gt; REJECTED_RECREATE_SIGNING status with a reason for rejection and &lt;br/&gt; a BAX Number assuming the agreement was rejected by the bank\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Resend signing request on Agreement\nI -&gt;&gt; O: PUT /agreement/{orderId}/resend-signing-email\nnote right of O: This is intended to be utilized if signing &lt;br/&gt; requirements change and need to be updated &lt;br/&gt; or if previous signature was rejected.\n\nO --&gt;&gt; I: 202 Accepted\nO -&gt;&gt; O: Send email to customer\n</code></pre>"},{"location":"test_flows/","title":"Valid flows for Test","text":""},{"location":"test_flows/#automatically-approved-signatures","title":"Automatically Approved Signatures","text":"<p>An order is created with and signed by the correct signee(s) and the signatures are automatically approved</p> <pre><code>sequenceDiagram\nparticipant I as Integrator\nparticipant O as Onboarding API\n\nnote over I, O: Register new agreement\nI -&gt;&gt; O: PUT /register/merchantAgreement\nnote right of O: We validate: Account Ownership and Account Number. &lt;br/&gt; We provide the ability to bypass account ownership validation &lt;br/&gt; and more information regarding valid account numbers &lt;br/&gt; can be found in our documentation\nO --&gt;&gt; I: 200 OK with orderId\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in &lt;br/&gt; NOT_SIGNED status with a BAX Number\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Simulate signing of agreement\nI -&gt;&gt; O: POST /simulate/signing\nnote right of O: You must send signee(s) that have signature rights &lt;br/&gt; based on the information in BRREG for the flow to &lt;br/&gt; continue following this diagram\nO --&gt;&gt; I: 202 Accepted\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in &lt;br/&gt; BAX_ACTIVE status\nO --&gt;&gt; I: 200 OK with Agreement\n</code></pre>"},{"location":"test_flows/#signatures-approved-by-bank","title":"Signatures Approved by Bank","text":"<p>An order is created with and signed by signee(s) that can not be validated based on the info in BRREG and the signatures are automatically rejected but then approved by the bank</p> <pre><code>sequenceDiagram\nparticipant I as Integrator\nparticipant O as Onboarding API\n\nnote over I, O: Register new agreement\nI -&gt;&gt; O: PUT /register/merchantAgreement\nnote right of O: We validate: Account Ownership and Account Number. &lt;br/&gt; We provide the ability to bypass account ownership validation &lt;br/&gt; and more information regarding valid account numbers &lt;br/&gt; can be found in our documentation\nO --&gt;&gt; I: 200 OK with orderId\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in &lt;br/&gt; NOT_SIGNED status with a BAX Number\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Simulate signing of agreement\nI -&gt;&gt; O: POST /simulate/signing\nnote right of O: You must send signee(s) that have signature rights &lt;br/&gt; based on the information in BRREG for the flow to &lt;br/&gt; continue following this diagram\nO --&gt;&gt; I: 202 Accepted\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in &lt;br/&gt; SIGNED_AWAITING_BANK status\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Simulate Bank Response on Agreement\nI -&gt;&gt; O: POST /simulate/bank/approve/signatures\nO --&gt;&gt; I: 202 Accepted\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will simulate the bank approving the signature(s) &lt;br/&gt; and should result in ACCEPTED status\nO --&gt;&gt; I: 200 OK with Agreement\n</code></pre>"},{"location":"test_flows/#signatures-rejected-by-bank","title":"Signatures Rejected by Bank","text":"<p>An order is created with and signed by signee(s) that can not be validated based on the info in BRREG and the signatures are automatically rejected and later rejected by the bank</p> <pre><code>sequenceDiagram\nparticipant I as Integrator\nparticipant O as Onboarding API\n\nnote over I, O: Register new agreement\nI -&gt;&gt; O: PUT /register/merchantAgreement\nnote right of O: We validate: Account Ownership and Account Number. &lt;br/&gt; We provide the ability to bypass account ownership validation &lt;br/&gt; and more information regarding valid account numbers &lt;br/&gt; can be found in our documentation\nO --&gt;&gt; I: 200 OK with orderId\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in &lt;br/&gt; NOT_SIGNED status with a BAX Number\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Simulate signing of agreement\nI -&gt;&gt; O: POST /simulate/signing\nnote right of O: You must send signee(s) that do not have signature rights &lt;br/&gt; based on the information in BRREG for the flow to &lt;br/&gt; continue following this diagram\nO --&gt;&gt; I: 202 Accepted\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will return the agreement details. &lt;br/&gt; After a few seconds it should result in &lt;br/&gt; SIGNED_AWAITING_BANK status\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Simulate Bank Response on Agreement\nI -&gt;&gt; O: POST /simulate/bank/reject/signatures\nO --&gt;&gt; I: 202 Accepted\n\nnote over I, O: Check status of agreement\nI -&gt;&gt; O: GET /agreement/{orderId}\nnote right of O: This will simulate the bank rejecting the signature(s) &lt;br/&gt; and should result in a REJECTED_RECREATE_SIGNING status with a reason for rejection\nO --&gt;&gt; I: 200 OK with Agreement\n\nnote over I, O: Resend signing request on Agreement\nI -&gt;&gt; O: PUT /agreement/{orderId}/resend-signing-email\nnote right of O: This is intended to be utilized if signing &lt;br/&gt; requirements change and need to be updated &lt;br/&gt; or if previous signature was rejected.\n\nO --&gt;&gt; I: 202 Accepted\nO -&gt;&gt; O: Send email to customer\n</code></pre>"},{"location":"valid_account_numbers/","title":"Valid Account Numbers","text":"<p>The modulus 11 algorithm for Norwegian bank account numbers is used to validate the check digit at the end of the account number.</p>"},{"location":"valid_account_numbers/#structure","title":"Structure","text":"<p>A Norwegian bank account number consists of 11 digits, where the first 4 digits represent the bank reg number and the last digit is a check digit. </p>"},{"location":"valid_account_numbers/#calculation","title":"Calculation","text":"<p>To display the calculation of the check digit, we will use the following example account number: </p> <pre><code>15067328555\n</code></pre>"},{"location":"valid_account_numbers/#weights","title":"Weights","text":"<p>Assign weights to the first 10 digits of the account number. The weights are: 2, 3, 4, 5, 6, 7, 2, 3, 4, 5 (repeating after 7).</p> <pre><code>5 (weight 3)\n5 (weight 4)\n8 (weight 5)\n2 (weight 6)\n3 (weight 7)\n7 (weight 2)\n6 (weight 3)\n0 (weight 4)\n5 (weight 5)\n1 (weight 6)\n</code></pre>"},{"location":"valid_account_numbers/#multiply-and-sum","title":"Multiply and Sum","text":"<p>Multiply each digit by its corresponding weight and sum the results:</p> <pre><code>5 * 3 = 15\n5 * 4 = 20\n8 * 5 = 40\n2 * 6 = 12\n3 * 7 = 21\n7 * 2 = 14\n6 * 3 = 18\n0 * 4 = 0\n5 * 5 = 25\n1 * 6 = 6\n</code></pre> <p>The sum is </p> <pre><code>15 + 20 + 40 + 12 + 21 + 14 + 18 + 0 + 25 + 6 = 171\n</code></pre>"},{"location":"valid_account_numbers/#modulo-operation","title":"Modulo Operation","text":"<p>Now, take the sum and divide it by 11 and find the remainder:</p> <pre><code>171 % 11 = 6\n</code></pre>"},{"location":"valid_account_numbers/#check-digit","title":"Check Digit","text":"<p>Subtract the remainder from 11 to get the check digit:</p> <pre><code>11 - 6 = 5\n</code></pre> <p>It is important to note that if the result is 11, the check digit is 0. If the result is 10, the account number is invalid.</p> <p>In this case, the check digit is 5, which matches the last digit of the account number. Therefore, the account number 15067328555 is valid.</p>"},{"location":"webhooks/","title":"Webhooks","text":"<p>This is how the webhook flow works:</p> <ol> <li>When registering an agreement<ul> <li>Add a webhookUrl property to the register merchantAgreement payload ( <code>PUT /psp/v2/register/merchantAgreement</code> )</li> <li>Security measures<ul> <li>We expect the webhook callback URL to be an open endpoint</li> <li>In case the integrator needs to whitelist our callback, the following IP addresses are used from our end:<ul> <li>Test environment: <code>51.13.44.137</code></li> <li>Prod environment: <code>51.13.52.185</code></li> </ul> </li> </ul> </li> </ul> </li> <li>When the PSP calls the <code>PUT /psp/v2/register/merchantAgreement</code> endpoint to register an agreement order, you will get an <code>orderId</code> in the response (as per the existing API spec).    Whenever there is a change to the agreement order in our systems, we will do a POST call to the webhookUrl with the <code>orderId</code> in the request body, looking like this:</li> </ol> <pre><code>{\n  \"orderId\": \"af5505ad-4346-4c7e-8729-700bd0b92168\",\n  \"orderStatus\": \"PENDING_BANK_RESPONSE\"\n}\n</code></pre> <p>where the <code>orderStatus</code> refers to the statuses defined in the Possible Order Statuses</p> <ol> <li>The PSP should then call our existing endpoint to fetch the updated status ( <code>GET /psp/v2/register/{orderId}</code> )<ul> <li>The <code>registerMerchantOrderStatus</code> field in this response should give you the necessary information about the agreement registration order.</li> </ul> </li> </ol>"},{"location":"webhooks/#webhook-example-sequence-diagram","title":"Webhook example sequence diagram","text":"<pre><code>sequenceDiagram\n    participant Integrator\n    participant Onboarding API\n    participant Signees\n    participant Bank\n    Integrator-&gt;&gt;Onboarding API: registerAgreement (with webhook url)\n    Onboarding API-&gt;&gt;Integrator: POST webhook call (status change)\n    Integrator-&gt;&gt;Onboarding API: call agreement endpoint to get details\n    Onboarding API-&gt;&gt;Signees: email with signing link\n    Signees-&gt;&gt;Onboarding API: sign agreement\n    Onboarding API-&gt;&gt;Integrator: POST webhook call (status change)\n    Integrator-&gt;&gt;Onboarding API: call agreement endpoint to get details\n    Onboarding API-&gt;&gt;Bank: send agreement\n    Bank-&gt;&gt;Onboarding API: accepted\n    Onboarding API-&gt;&gt;Integrator: POST webhook call (status change)\n    Integrator-&gt;&gt;Onboarding API: call agreement endpoint to get details\n</code></pre>"}]}